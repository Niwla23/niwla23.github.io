__NUXT_JSONP__("/posts/lagersystem", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q){return {data:[{article:{slug:"lagersystem",description:t,title:"Automatic Warehouse",image:x,featured:o,tags:["backend","frontend","hardware","3d-druck"],toc:[{id:y,depth:p,text:z},{id:A,depth:p,text:B},{id:C,depth:u,text:D},{id:E,depth:u,text:F},{id:G,depth:u,text:H},{id:I,depth:p,text:J},{id:K,depth:p,text:L}],body:{type:M,children:[{type:b,tag:f,props:{},children:[{type:a,value:t}]},{type:a,value:c},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:"video",props:{muted:o,autoPlay:o,loop:o},children:[{type:a,value:n},{type:b,tag:"source",props:{src:"\u002Flagersystem\u002Fvideo.mp4",type:"video\u002Fmp4"},children:[]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:n},{type:b,tag:q,props:{src:"\u002Flagersystem\u002Fcarriage.jpg",alt:r},children:[{type:a,value:c}]}]},{type:a,value:c},{type:b,tag:s,props:{id:y},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#motors",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:z}]},{type:a,value:c},{type:b,tag:v,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"X Axis (Left and Right): One NEMA17 Stepper, Belt driven with pulley"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Y Axis (Hoch und Runter): One NEMA17 Stepper on each side, Belt driven with pulley"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Z Axis (In and Out): One NEMA17 stepper with a spindle."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:n},{type:b,tag:q,props:{src:"\u002Flagersystem\u002FyMotor.jpg",alt:r},children:[{type:a,value:c}]}]},{type:a,value:c},{type:b,tag:s,props:{id:A},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#software",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"The software is split up into three parts, running on different systems."}]},{type:a,value:c},{type:b,tag:w,props:{id:C},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#manager",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:D}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"The Manager Software is written in Go and React. It is the user-facing software to select a part for delivery. It is also the service that manages the Database.\nFollowing entities exist in the database:"}]},{type:a,value:c},{type:b,tag:v,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Part"}]},{type:a,value:": A part can be linked to a box. This allows to have multiple parts in one Box and dynamically change the box of a part without deleting it."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Tag"}]},{type:a,value:": Can be assigned to parts for easier filtering. M2M to parts."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Box"}]},{type:a,value:": Represents a physical box. Has relations to the parts in it and a one to one to a position."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Position"}]},{type:a,value:": Is only a ID with a relation to the stored box (if any)"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"Manager uses the API of the Operator Service to Deliver Boxes and update the db accordingly. It also proxies some of its APIs like "},{type:b,tag:d,props:{},children:[{type:a,value:N}]},{type:a,value:". Manager is also responsible for\n\"clearing IO\" (storing all boxes that are in IO at free positions) as this involves database operations."}]},{type:a,value:c},{type:b,tag:w,props:{id:E},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#operator",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:F}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"This is a python service running on the raspberry pi zero connected to the Arduino. It sends G-Code to GRBL.\nIt exposes following HTTP API:"}]},{type:a,value:c},{type:b,tag:v,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:N}]},{type:a,value:": returns the occupancy of the IO Slots."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"deliverBox(posId)"}]},{type:a,value:": delivers a box to a free IO Slot by Position Id."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"storeBox(posId, ioSlot)"}]},{type:a,value:O},{type:b,tag:d,props:{},children:[{type:a,value:P}]},{type:a,value:" and stores it at "},{type:b,tag:d,props:{},children:[{type:a,value:"posId"}]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"scanBoxId(ioSlot)"}]},{type:a,value:O},{type:b,tag:d,props:{},children:[{type:a,value:P}]},{type:a,value:", scans it and stores it at the scanner position. It then returns the boxId."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"getPositions"}]},{type:a,value:" the operator has configured coordinates for each possible box position. These are returned by this endpoint."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"The Operator also handles the pushbuttons on the warehouse (clear IO, light color, reboot, home, standby), auto-standby with auto wakeup and Neopixel LED Strip."}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"All operations done by the operator are \"atomic\" (system is always in a safe state after performing action, no box on carriage after operation) to prevent\nvery bad things from happening. Otherwise the operator may do a scan, keep the box on the carriage, then the manager fails for some reason and then tries to pick up a box with a box still\nloaded."}]},{type:a,value:c},{type:b,tag:w,props:{id:G},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#firmware",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:H}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"The Firmware runs on an Arduino and is just a normal GRBL, which is a firmware meant for CNC Routers. It accepts GCode commands over USB and manages queuing as well as acceleration."}]},{type:a,value:c},{type:b,tag:s,props:{id:I},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#scanner",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:J}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"To detect which box is currently in the scanner, I use a raspberry pi camera and the "},{type:b,tag:d,props:{},children:[{type:a,value:"zxing-cpp"}]},{type:a,value:" library to decode the QR Codes that are attached to the back of the drawers.\nThe code contains a UUIDv4 that is registered in the database."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:n},{type:b,tag:q,props:{src:"\u002Flagersystem\u002Fscanner.jpg",alt:r},children:[{type:a,value:c}]}]},{type:a,value:c},{type:b,tag:s,props:{id:K},children:[{type:b,tag:g,props:{ariaHidden:h,href:"#occupancy-detection-of-io-slots",tabIndex:i},children:[{type:b,tag:j,props:{className:[k,l]},children:[]}]},{type:a,value:L}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"The warehouse has "},{type:b,tag:"strong",props:{},children:[{type:a,value:"three IO Slots"}]},{type:a,value:" for putting in boxes for storing or taking drawers out. As the \"state\" of these IO Slots is meant to be modified by the user, the system needs sensors\nto detect which IO Slots are free. For this I used cheap IR proximity sensors. They are connected to the raspberry pi zero"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:n},{type:b,tag:q,props:{src:x,alt:r},children:[{type:a,value:c}]}]}]},excerpt:{type:M,children:[{type:b,tag:f,props:{},children:[{type:a,value:t}]}]},dir:"\u002Fposts",path:"\u002Fposts\u002Flagersystem",extension:".md",createdAt:Q,updatedAt:Q},_img:{"/_ipx/s_1280x584/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F4bcee7.jpg","/_ipx/f_jpeg,w_320,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002F1e0a6b.jpeg","/_ipx/f_jpeg,w_640,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fb27574.jpeg","/_ipx/f_jpeg,w_768,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002F8f3c26.jpeg","/_ipx/f_jpeg,w_1024,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fc02717.jpeg","/_ipx/f_jpeg,w_1280,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Ff4112d.jpeg","/_ipx/f_jpeg,w_1536,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fead2b4.jpeg","/_ipx/f_webp,w_320,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fd8c95f.webp","/_ipx/f_webp,w_640,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002F1ba6a2.webp","/_ipx/f_webp,w_768,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fc05316.webp","/_ipx/f_webp,w_1024,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002F430908.webp","/_ipx/f_webp,w_1280,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002F4ab6e8.webp","/_ipx/f_webp,w_1536,fit_inside/lagersystem/carriage.jpg":"\u002F_nuxt\u002Fimage\u002Fccca6b.webp","/_ipx/f_jpeg,w_320,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F7b8506.jpeg","/_ipx/f_jpeg,w_640,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F21b464.jpeg","/_ipx/f_jpeg,w_768,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F2a03bb.jpeg","/_ipx/f_jpeg,w_1024,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F55e2c3.jpeg","/_ipx/f_jpeg,w_1280,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F8fb7b8.jpeg","/_ipx/f_jpeg,w_1536,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F5caa8b.jpeg","/_ipx/f_webp,w_320,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F28c7c3.webp","/_ipx/f_webp,w_640,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002Fdfd1f2.webp","/_ipx/f_webp,w_768,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F965117.webp","/_ipx/f_webp,w_1024,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002Fa3ca1c.webp","/_ipx/f_webp,w_1280,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F1dbaac.webp","/_ipx/f_webp,w_1536,fit_inside/lagersystem/yMotor.jpg":"\u002F_nuxt\u002Fimage\u002F882932.webp","/_ipx/f_jpeg,w_320,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002Fded11c.jpeg","/_ipx/f_jpeg,w_640,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F4c20d0.jpeg","/_ipx/f_jpeg,w_768,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F5080bf.jpeg","/_ipx/f_jpeg,w_1024,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F21db14.jpeg","/_ipx/f_jpeg,w_1280,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002Fd634be.jpeg","/_ipx/f_jpeg,w_1536,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F7c3c79.jpeg","/_ipx/f_webp,w_320,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F74aa36.webp","/_ipx/f_webp,w_640,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002Fedaf30.webp","/_ipx/f_webp,w_768,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F45c614.webp","/_ipx/f_webp,w_1024,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F3d3879.webp","/_ipx/f_webp,w_1280,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F611f66.webp","/_ipx/f_webp,w_1536,fit_inside/lagersystem/scanner.jpg":"\u002F_nuxt\u002Fimage\u002F2a5da8.webp","/_ipx/f_jpeg,w_320,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002Ff91d13.jpeg","/_ipx/f_jpeg,w_640,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F8ff6f6.jpeg","/_ipx/f_jpeg,w_768,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F948a4c.jpeg","/_ipx/f_jpeg,w_1024,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002Fec47e2.jpeg","/_ipx/f_jpeg,w_1280,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002Fa9f9f6.jpeg","/_ipx/f_jpeg,w_1536,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F7dd07d.jpeg","/_ipx/f_webp,w_320,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F31cc58.webp","/_ipx/f_webp,w_640,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F76bb2f.webp","/_ipx/f_webp,w_768,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002Fe4b7cd.webp","/_ipx/f_webp,w_1024,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F9c1358.webp","/_ipx/f_webp,w_1280,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F2bfaa2.webp","/_ipx/f_webp,w_1536,fit_inside/lagersystem/thumb.jpg":"\u002F_nuxt\u002Fimage\u002F651680.webp","/_ipx/w_320,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F0a404b.png","/_ipx/w_640,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002Fa9de22.png","/_ipx/w_768,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F6fd3de.png","/_ipx/w_1024,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F9c8214.png","/_ipx/w_1280,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002Fe1b1d3.png","/_ipx/w_1536,f_png,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F1cfc49.png","/_ipx/w_320,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F98e7a7.webp","/_ipx/w_640,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F82becb.webp","/_ipx/w_768,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F4f68f8.webp","/_ipx/w_1024,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F96a92d.webp","/_ipx/w_1280,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F3503f4.webp","/_ipx/w_1536,f_webp,fit_inside/icon.png":"\u002F_nuxt\u002Fimage\u002F8c5f4e.webp"}}],fetch:{},mutations:void 0}}("text","element","\n","code","li","p","a","true",-1,"span","icon","icon-link","div","\n  ",true,2,"block-image","Y axis motor","h2","A fully automatic warehouse using part boxes from the hardware store with (potentially) 192 Boxes. It works by moving a carriage with an extendable part that goes into\nthe warehouse, hooks into a box and pulls it out. (and vice-versa)",3,"ul","h3","\u002Flagersystem\u002Fthumb.jpg","motors","Motors","software","Software","manager","Manager","operator","Operator","firmware","Firmware","scanner","Scanner","occupancy-detection-of-io-slots","Occupancy detection of IO Slots","root","getIOState"," picks a box up from ","ioSlot","2023-07-19T16:18:10.000Z")));